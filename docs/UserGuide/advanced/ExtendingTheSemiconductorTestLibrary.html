<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Extending The Semiconductor Test Library | Semiconductor Test Library </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Extending The Semiconductor Test Library | Semiconductor Test Library ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ni/semi-test-library-dotnet/blob/users/mattjet27/add-initial-documentation/docs/source/UserGuide/advanced/ExtendingTheSemiconductorTestLibrary.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="Semiconductor Test Library">
            Semiconductor Test Library
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="extending-the-semiconductor-test-library">Extending The Semiconductor Test Library</h1>

<p>The Semiconductor Test Library provides extension methods for abstracting common, high-level instrument operations.</p>
<p>If you are unfamiliar Extension Methods, they are static methods that can be called as if they were instance methods for the object type they extend. For tests code being written, there's no apparent difference between calling an extension method and calling the methods defined in a type.</p>
<ul>
<li>Extension methods enable the developer to &quot;add&quot; methods to existing types without creating a new derived type, recompiling, or otherwise modifying the original type.</li>
<li>An extension method will never be called if it has the same signature as a method defined in the type. So extension method can never be used to impersonate existing methods on a type, because all name collisions are resolved in favor of the instance or static method defined by the type itself.</li>
<li>Extension methods cannot access any private data in the extended class.</li>
<li>Learn more at: <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods">https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods</a>.</li>
</ul>
<h2 id="writing-your-own-extension-method">Writing Your Own Extension Method</h2>
<p>It is recommended that you start by creating a separate .cs file to write your project-specific extensions in, with it's own unique namespace. It must contain a static class, which should use the same name as the file name. You then write out a new static method, with the first parameter being the target class you wish to extend proceeded by the <code>this</code> keyword. Finally, can add other parameters to method signature and your desired logic within the method body. Refer to the example below, which extends <code>PinSiteData</code> to have a <code>MaxByPin()</code> method that calculates the per-site maximum value across each pin.</p>
<pre><code class="lang-C#">// FileName: MyProjectExtensions.cs
using System.Collections.Generic;
using System.Linq;
using NationalInstruments.SemiconductorTestLibrary.DataAbstraction;

namespace NationalInstruments.MyProject.Extensions
{
    /// &lt;summary&gt;
    /// Class containing custom extension methods for MyProject.
    /// &lt;/summary&gt;
    public static class MyProjectExtensions
    {
        /// &lt;summary&gt;
        /// Calculates the per-site maximum value across each pin.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// &lt;example&gt;
        /// Example usage:
        /// &lt;code&gt;
        /// var measurements = dcPins.MeasureVoltage();
        /// var maxValueAcrossPins = measurements.MaxByPin();
        /// &lt;/code&gt;
        /// &lt;/example&gt;
        /// &lt;/remarks&gt;
        /// &lt;typeparam name=&quot;T&quot;&gt;The base type for the per-site per-pin data&lt;/typeparam&gt;
        /// &lt;param name=&quot;data&quot;&gt;The &lt;see cref=&quot;PinSiteData{T}&quot;/&gt; object&lt;/param&gt;
        /// &lt;returns&gt;
        /// Returns a new &lt;see cref=&quot;SiteData{T}&quot;/&gt; object,
        /// containing the per-site maximum values across all pins.
        /// &lt;/returns&gt;
        public static SiteData&lt;T&gt; MaxByPin&lt;T&gt;(this PinSiteData&lt;T&gt; data)
        {
            var perSiteMax = new Dictionary&lt;int, T&gt;();
            for (int siteIndex = 0; siteIndex &lt; data.SiteNumbers.Length; siteIndex++)
            {
                var perPinSingleSiteValues = new T[data.PinNames.Length];
                for (int pinIndex = 0; pinIndex &lt; data.PinNames.Length; pinIndex++)
                {
                    perPinSingleSiteValues[pinIndex] =
                    data.GetValue(data.SiteNumbers[siteIndex], data.PinNames[pinIndex]);
                }
                perSiteMax.Add(data.SiteNumbers[siteIndex], perPinSingleSiteValues.Max());
            }
            return new SiteData&lt;T&gt;(perSiteMax);
        }
    }
}
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ni/semi-test-library-dotnet/blob/users/mattjet27/add-initial-documentation/docs/source/UserGuide/advanced/ExtendingTheSemiconductorTestLibrary.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
